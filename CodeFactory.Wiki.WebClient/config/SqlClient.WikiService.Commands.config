<?xml version="1.0" encoding="utf-8" ?>
<dataOperations dataSource="WikiManagementService" xmlns="CodeFactory.DataAccess">
	<dataCommands>
		<dataCommand name="GetWiki" type="Text">
			<commandText>
				<![CDATA[
				SELECT COUNT(id) totalCount
				FROM wikis
				WHERE applicationName = @applicationName
					AND title = @title
					AND description like '%%' + @description + '%%'
					AND [content] like '%%' + @content + '%%'
					AND	author like '%%' + @author + '%%'
					AND isVisible = @isVisible
					AND slug = @slug
					AND category like '%%' + @category + '%%'
					AND keywords like '%%' + @keywords + '%%'
					AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated
					AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated
					AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%';
				WITH Ordered(id, rownumber) AS (
					SELECT id, ROW_NUMBER() OVER (ORDER BY title ASC) rownumber
					FROM wikis
					WHERE applicationName = @applicationName
						AND title = @title
						AND description like '%%' + @description + '%%'
						AND [content] like '%%' + @content + '%%'
						AND	author like '%%' + @author + '%%'
						AND isVisible = @isVisible
						AND slug = @slug
						AND category like '%%' + @category + '%%'
						AND keywords like '%%' + @keywords + '%%'
						AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated
						AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated
						AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%'
				)
				SELECT id
				FROM Ordered
				WHERE rownumber BETWEEN @firstIndex AND @lastIndex;
				]]>
			</commandText>
			<replaceByParamValues>
				<replaceByParamValue paramName="title" paramValue="">
					<oldString><![CDATA[AND title = @title]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="description" paramValue="">
					<oldString><![CDATA[AND description like '%%' + @description + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="content" paramValue="">
					<oldString><![CDATA[AND [content] like '%%' + @content + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="author" paramValue="">
					<oldString><![CDATA[AND author like '%%' + @author + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="isVisible" paramValue="DBNull.Value">
					<oldString><![CDATA[AND isVisible = @isVisible]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="slug" paramValue="">
					<oldString><![CDATA[AND slug = @slug]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="category" paramValue="">
					<oldString><![CDATA[AND category like '%%' + @category + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="keywords" paramValue="">
					<oldString><![CDATA[AND keywords like '%%' + @keywords + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="initialDateCreated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="finalDateCreated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="initialLastUpdated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="finalLastUpdated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="lastUpdatedBy" paramValue="">
					<oldString><![CDATA[AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
			</replaceByParamValues>
			<parameters>
				<param key="title" name="@title" type="VarChar" direction="Input"/>
				<param key="description" name="@description" type="VarChar" direction="Input"/>
				<param key="content" name="@content" type="VarChar" direction="Input"/>
				<param key="author" name="@author" type="VarChar" direction="Input"/>
				<param key="isVisible" name="@isVisible" type="Bit" direction="Input"/>
				<param key="slug" name="@slug" type="VarChar" direction="Input"/>
				<param key="category" name="@category" type="VarChar" direction="Input"/>
				<param key="keywords" name="@keywords" type="VarChar" direction="Input"/>
				<param key="initialDateCreated" name="@initialDateCreated" type="DateTime" direction="Input"/>
				<param key="finalDateCreated" name="@finalDateCreated" type="DateTime" direction="Input"/>
				<param key="initialLastUpdated" name="@initialLastUpdated" type="DateTime" direction="Input"/>
				<param key="finalLastUpdated" name="@finalLastUpdated" type="DateTime" direction="Input"/>
				<param key="lastUpdatedBy" name="@lastUpdatedBy" type="VarChar" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
        <param key="firstIndex" name="@firstIndex" type="Int" direction="Input"/>
				<param key="lastIndex" name="@lastIndex" type="Int" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="SelectWiki" type="Text">
			<commandText>
				<![CDATA[
				SELECT title, description, [content], author, isVisible, slug, category, 
					keywords, dateCreated, lastUpdated, lastUpdatedBy, reachLevel, editable,
					editor, departmentArea
				FROM wikis
				WHERE id = @id
				]]>
			</commandText>
			<parameters>
				<param key="id" name="@id" type="UniqueIdentifier" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="UpdateWiki" type="Text">
			<commandText>
				<![CDATA[
				UPDATE wikis
				SET title = @title, description = @description, [content] = @content, author = @author, 
					isVisible = @isVisible, slug = @slug, category = @category, keywords = @keywords, 
					dateCreated = @dateCreated, lastUpdated = @lastUpdated, lastUpdatedBy = @lastUpdatedBy,
					reachLevel = @reachLevel, editable = @editable, editor = @editor, departmentArea = @departmentArea,
          applicationName = @applicationName
				WHERE id = @id
				]]>
			</commandText>
			<parameters>
				<param key="id" name="@id" type="UniqueIdentifier" direction="Input"/>
				<param key="title" name="@title" type="VarChar" direction="Input"/>
				<param key="description" name="@description" type="VarChar" direction="Input"/>
				<param key="content" name="@content" type="VarChar" direction="Input"/>
				<param key="author" name="@author" type="VarChar" direction="Input"/>
				<param key="isVisible" name="@isVisible" type="Bit" direction="Input"/>
				<param key="slug" name="@slug" type="VarChar" direction="Input" isNullable="true"/>
				<param key="category" name="@category" type="VarChar" direction="Input"/>
				<param key="keywords" name="@keywords" type="VarChar" direction="Input" isNullable="true"/>
				<param key="dateCreated" name="@dateCreated" type="DateTime" direction="Input"/>
				<param key="lastUpdated" name="@lastUpdated" type="DateTime" direction="Input" isNullable="true"/>
				<param key="lastUpdatedBy" name="@lastUpdatedBy" type="VarChar" direction="Input" isNullable="true"/>
				<param key="reachLevel" name="@reachLevel" type="Int" direction="Input"/>
				<param key="editable" name="@editable" type="Bit" direction="Input"/>
				<param key="editor" name="@editor" type="VarChar" direction="Input"/>
				<param key="departmentArea" name="@departmentArea" type="VarChar" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
		</dataCommand>
		<dataCommand name="InsertWiki" type="Text">
			<commandText>
				<![CDATA[
				INSERT INTO wikis
				(id, title, description, [content], author, isVisible, slug, category, keywords, 
					dateCreated, lastUpdated, lastUpdatedBy, reachLevel, editable, editor, departmentArea, applicationName)
				VALUES (@id, @title, @description, @content, @author, @isVisible, @slug, @category, @keywords, 
					@dateCreated, @lastUpdated, @lastUpdatedBy, @reachLevel, @editable, @editor, @departmentArea, @applicationName)
				]]>
			</commandText>
			<parameters>
				<param key="id" name="@id" type="UniqueIdentifier" direction="Input"/>
				<param key="title" name="@title" type="VarChar" direction="Input"/>
				<param key="description" name="@description" type="VarChar" direction="Input"/>
				<param key="content" name="@content" type="VarChar" direction="Input"/>
				<param key="author" name="@author" type="VarChar" direction="Input"/>
				<param key="isVisible" name="@isVisible" type="Bit" direction="Input"/>
				<param key="slug" name="@slug" type="VarChar" direction="Input" isNullable="true"/>
				<param key="category" name="@category" type="VarChar" direction="Input"/>
				<param key="keywords" name="@keywords" type="VarChar" direction="Input" isNullable="true"/>
				<param key="dateCreated" name="@dateCreated" type="DateTime" direction="Input"/>
				<param key="lastUpdated" name="@lastUpdated" type="DateTime" direction="Input" isNullable="true"/>
				<param key="lastUpdatedBy" name="@lastUpdatedBy" type="VarChar" direction="Input" isNullable="true"/>
				<param key="reachLevel" name="@reachLevel" type="Int" direction="Input"/>
				<param key="editable" name="@editable" type="Bit" direction="Input"/>
				<param key="editor" name="@editor" type="VarChar" direction="Input"/>
				<param key="departmentArea" name="@departmentArea" type="VarChar" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
		</dataCommand>
		<dataCommand name="DeleteWiki" type="Text">
			<commandText>
				<![CDATA[
				DELETE wikis
				WHERE id = @id
				]]>
			</commandText>
			<parameters>
				<param key="id" name="@id" type="UniqueIdentifier" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="GetWikiHistory" type="Text">
			<commandText>
				<![CDATA[
				SELECT COUNT(trackingNumber) totalCount
				FROM wikisHistory
				WHERE 1 = 1
					AND id = @id
					AND title = @title
					AND description like '%%' + @description + '%%'
					AND [content] like '%%' + @content + '%%'
					AND	author like '%%' + @author + '%%'
					AND isVisible = @isVisible
					AND slug = @slug
					AND category like '%%' + @category + '%%'
					AND keywords like '%%' + @keywords + '%%'
					AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated
					AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated
          AND expirationDate BETWEEN @initialExpirationDate AND @finalExpirationDate
					AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%';
				WITH Ordered(trackingNumber, rownumber) AS (
					SELECT trackingNumber, ROW_NUMBER() OVER (ORDER BY lastUpdated DESC) rownumber
					FROM wikisHistory
					WHERE applicationName = @applicationName
						AND id = @id
						AND title = @title
						AND description like '%%' + @description + '%%'
						AND [content] like '%%' + @content + '%%'
						AND	author like '%%' + @author + '%%'
						AND isVisible = @isVisible
						AND slug = @slug
						AND category like '%%' + @category + '%%'
						AND keywords like '%%' + @keywords + '%%'
						AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated
						AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated
            AND expirationDate BETWEEN @initialExpirationDate AND @finalExpirationDate
						AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%'
				)
				SELECT trackingNumber
				FROM Ordered
				WHERE rownumber BETWEEN @firstIndex AND @lastIndex;
				]]>
			</commandText>
			<replaceByParamValues>
				<replaceByParamValue paramName="id" paramValue="DBNull.Value">
					<oldString><![CDATA[AND id = @id]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="title" paramValue="">
					<oldString><![CDATA[AND title = @title]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="description" paramValue="">
					<oldString><![CDATA[AND description like '%%' + @description + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="content" paramValue="">
					<oldString><![CDATA[AND [content] like '%%' + @content + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="author" paramValue="">
					<oldString><![CDATA[AND author like '%%' + @author + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="isVisible" paramValue="DBNull.Value">
					<oldString><![CDATA[AND isVisible = @isVisible]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="slug" paramValue="">
					<oldString><![CDATA[AND slug = @slug]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="category" paramValue="">
					<oldString><![CDATA[AND category like '%%' + @category + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="keywords" paramValue="">
					<oldString><![CDATA[AND keywords like '%%' + @keywords + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="initialDateCreated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="finalDateCreated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="initialLastUpdated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="finalLastUpdated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
        <replaceByParamValue paramName="initialExpirationDate" paramValue="DBNull.Value">
          <oldString><![CDATA[AND expirationDate BETWEEN @initialExpirationDate AND @finalExpirationDate]]></oldString>
          <newString><![CDATA[]]></newString>
        </replaceByParamValue>
        <replaceByParamValue paramName="finalExpirationDate" paramValue="DBNull.Value">
          <oldString><![CDATA[AND expirationDate BETWEEN @initialExpirationDate AND @finalExpirationDate]]></oldString>
          <newString><![CDATA[]]></newString>
        </replaceByParamValue>
        <replaceByParamValue paramName="lastUpdatedBy" paramValue="">
					<oldString><![CDATA[AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
			</replaceByParamValues>
			<parameters>
				<param key="id" name="@id" type="UniqueIdentifier" direction="Input"/>
				<param key="title" name="@title" type="VarChar" direction="Input"/>
				<param key="description" name="@description" type="VarChar" direction="Input"/>
				<param key="content" name="@content" type="VarChar" direction="Input"/>
				<param key="author" name="@author" type="VarChar" direction="Input"/>
				<param key="isVisible" name="@isVisible" type="Bit" direction="Input"/>
				<param key="slug" name="@slug" type="VarChar" direction="Input"/>
				<param key="category" name="@category" type="VarChar" direction="Input"/>
				<param key="keywords" name="@keywords" type="VarChar" direction="Input"/>
				<param key="initialDateCreated" name="@initialDateCreated" type="DateTime" direction="Input"/>
				<param key="finalDateCreated" name="@finalDateCreated" type="DateTime" direction="Input"/>
				<param key="initialLastUpdated" name="@initialLastUpdated" type="DateTime" direction="Input"/>
				<param key="finalLastUpdated" name="@finalLastUpdated" type="DateTime" direction="Input"/>
        <param key="initialExpirationDate" name="@initialExpirationDate" type="DateTime" direction="Input"/>
        <param key="finalExpirationDate" name="@finalExpirationDate" type="DateTime" direction="Input"/>
        <param key="lastUpdatedBy" name="@lastUpdatedBy" type="VarChar" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
        <param key="firstIndex" name="@firstIndex" type="Int" direction="Input"/>
				<param key="lastIndex" name="@lastIndex" type="Int" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="SelectWorkWikiItem" type="Text">
			<commandText>
				<![CDATA[
				SELECT id, title, description, [content], author, isVisible, slug, category, 
					keywords, dateCreated, lastUpdated, expirationDate, lastUpdatedBy, reachLevel, editable, 
					editor, departmentArea, status, messages, authorizer, action, ipAddress
				FROM workWikiItems
				WHERE trackingNumber = @trackingNumber
				]]>
			</commandText>
			<parameters>
				<param key="trackingNumber" name="@trackingNumber" type="UniqueIdentifier" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="UpdateWorkWikiItem" type="Text">
			<commandText>
				<![CDATA[
				UPDATE workWikiItems
				SET id = @id, title = @title, description = @description, [content] = @content, author = @author, 
					isVisible = @isVisible, slug = @slug, category = @category, keywords = @keywords, 
					dateCreated = @dateCreated, lastUpdated = @lastUpdated, expirationDate = @expirationDate,
					lastUpdatedBy = @lastUpdatedBy, reachLevel = @reachLevel, editable = @editable,
					editor = @editor, departmentArea = @departmentArea, status = @status, messages = @messages,
					authorizer = @authorizer, action = @action, ipAddress = @ipAddress, applicationName = @applicationName
				WHERE trackingNumber = @trackingNumber
				]]>
			</commandText>
			<parameters>
				<param key="trackingNumber" name="@trackingNumber" type="UniqueIdentifier" direction="Input"/>
				<param key="id" name="@id" type="UniqueIdentifier" direction="Input"/>
				<param key="title" name="@title" type="VarChar" direction="Input"/>
				<param key="description" name="@description" type="VarChar" direction="Input"/>
				<param key="content" name="@content" type="VarChar" direction="Input"/>
				<param key="author" name="@author" type="VarChar" direction="Input"/>
				<param key="isVisible" name="@isVisible" type="Bit" direction="Input"/>
				<param key="slug" name="@slug" type="VarChar" direction="Input" isNullable="true"/>
				<param key="category" name="@category" type="VarChar" direction="Input"/>
				<param key="keywords" name="@keywords" type="VarChar" direction="Input" isNullable="true"/>
				<param key="dateCreated" name="@dateCreated" type="DateTime" direction="Input"/>
				<param key="lastUpdated" name="@lastUpdated" type="DateTime" direction="Input" isNullable="true"/>
				<param key="expirationDate" name="@expirationDate" type="DateTime" direction="Input" isNullable="true"/>
				<param key="lastUpdatedBy" name="@lastUpdatedBy" type="VarChar" direction="Input" isNullable="true"/>
				<param key="reachLevel" name="@reachLevel" type="Int" direction="Input"/>
				<param key="editable" name="@editable" type="Bit" direction="Input"/>
				<param key="editor" name="@editor" type="VarChar" direction="Input" isNullable="true"/>
				<param key="departmentArea" name="@departmentArea" type="VarChar" direction="Input" isNullable="true"/>
				<param key="status" name="@status" type="Int" direction="Input"/>
				<param key="messages" name="@messages" type="VarChar" direction="Input" isNullable="true"/>
				<param key="authorizer" name="@authorizer" type="VarChar" direction="Input" isNullable="true"/>
				<param key="action" name="@action" type="Int" direction="Input"/>
				<param key="ipAddress" name="@ipAddress" type="VarChar" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
		</dataCommand>
		<dataCommand name="InsertWorkWikiItem" type="Text">
			<commandText>
				<![CDATA[
				INSERT INTO workWikiItems
				(id, trackingNumber, title, description, [content], author, isVisible, slug, 
					category, keywords, dateCreated, lastUpdated, expirationDate, lastUpdatedBy, reachLevel, editable, 
					editor, departmentArea, status, messages, authorizer, action, ipAddress, applicationName)
				VALUES (@id, @trackingNumber, @title, @description, @content, @author, @isVisible, @slug, 
					@category, @keywords, @dateCreated, @lastUpdated, @expirationDate, @lastUpdatedBy, @reachLevel, @editable, 
					@editor, @departmentArea, @status, @messages, @authorizer, @action, @ipAddress, @applicationName)
				]]>
			</commandText>
			<parameters>
				<param key="trackingNumber" name="@trackingNumber" type="UniqueIdentifier" direction="Input"/>
				<param key="id" name="@id" type="UniqueIdentifier" direction="Input"/>
				<param key="title" name="@title" type="VarChar" direction="Input"/>
				<param key="description" name="@description" type="VarChar" direction="Input"/>
				<param key="content" name="@content" type="VarChar" direction="Input"/>
				<param key="author" name="@author" type="VarChar" direction="Input"/>
				<param key="isVisible" name="@isVisible" type="Bit" direction="Input"/>
				<param key="slug" name="@slug" type="VarChar" direction="Input" isNullable="true"/>
				<param key="category" name="@category" type="VarChar" direction="Input"/>
				<param key="keywords" name="@keywords" type="VarChar" direction="Input" isNullable="true"/>
				<param key="dateCreated" name="@dateCreated" type="DateTime" direction="Input"/>
				<param key="lastUpdated" name="@lastUpdated" type="DateTime" direction="Input" isNullable="true"/>
				<param key="expirationDate" name="@expirationDate" type="DateTime" direction="Input" isNullable="true"/>
				<param key="lastUpdatedBy" name="@lastUpdatedBy" type="VarChar" direction="Input" isNullable="true"/>
				<param key="reachLevel" name="@reachLevel" type="Int" direction="Input"/>
				<param key="editable" name="@editable" type="Bit" direction="Input"/>
				<param key="editor" name="@editor" type="VarChar" direction="Input" isNullable="true"/>
				<param key="departmentArea" name="@departmentArea" type="VarChar" direction="Input" isNullable="true"/>
				<param key="status" name="@status" type="Int" direction="Input"/>
				<param key="messages" name="@messages" type="VarChar" direction="Input" isNullable="true"/>
				<param key="authorizer" name="@authorizer" type="VarChar" direction="Input" isNullable="true"/>
				<param key="action" name="@action" type="Int" direction="Input"/>
				<param key="ipAddress" name="@ipAddress" type="VarChar" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
		</dataCommand>
		<dataCommand name="DeleteWorkWikiItem" type="Text">
			<commandText>
				<![CDATA[
				DELETE workWikiItems
				WHERE trackingNumber = @trackingNumber
				]]>
			</commandText>
			<parameters>
				<param key="trackingNumber" name="@trackingNumber" type="UniqueIdentifier" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="GetWorkWikiItem" type="Text">
			<commandText>
				<![CDATA[
				SELECT COUNT(trackingNumber) totalCount
				FROM workWikiItems
				WHERE applicationName = @applicationName
					AND id = @id
					AND title = @title
					AND description like '%%' + @description + '%%'
					AND [content] like '%%' + @content + '%%'
					AND	author like '%%' + @author + '%%'
					AND isVisible = @isVisible
					AND slug = @slug
					AND category like '%%' + @category + '%%'
					AND keywords like '%%' + @keywords + '%%'
					AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated
					AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated
          AND expirationDate BETWEEN @initialExpirationDate AND @finalExpirationDate
					AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%';
				WITH Ordered(trackingNumber, rownumber) AS (
					SELECT trackingNumber, ROW_NUMBER() OVER (ORDER BY expirationDate ASC) rownumber
					FROM workWikiItems
					WHERE applicationName = @applicationName
						AND id = @id
						AND title = @title
						AND description like '%%' + @description + '%%'
						AND [content] like '%%' + @content + '%%'
						AND	author like '%%' + @author + '%%'
						AND isVisible = @isVisible
						AND slug = @slug
						AND category like '%%' + @category + '%%'
						AND keywords like '%%' + @keywords + '%%'
						AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated
						AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated
            AND expirationDate BETWEEN @initialExpirationDate AND @finalExpirationDate
						AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%'
				)
				SELECT trackingNumber
				FROM Ordered
				WHERE rownumber BETWEEN @firstIndex AND @lastIndex;
				]]>
			</commandText>
			<replaceByParamValues>
				<replaceByParamValue paramName="id" paramValue="DBNull.Value">
					<oldString><![CDATA[AND id = @id]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="title" paramValue="">
					<oldString><![CDATA[AND title = @title]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="description" paramValue="">
					<oldString><![CDATA[AND description like '%%' + @description + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="content" paramValue="">
					<oldString><![CDATA[AND [content] like '%%' + @content + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="author" paramValue="">
					<oldString><![CDATA[AND author like '%%' + @author + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="isVisible" paramValue="DBNull.Value">
					<oldString><![CDATA[AND isVisible = @isVisible]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="slug" paramValue="">
					<oldString><![CDATA[AND slug = @slug]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="category" paramValue="">
					<oldString><![CDATA[AND category like '%%' + @category + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="keywords" paramValue="">
					<oldString><![CDATA[AND keywords like '%%' + @keywords + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="initialDateCreated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="finalDateCreated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="initialLastUpdated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="finalLastUpdated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
        <replaceByParamValue paramName="initialExpirationDate" paramValue="DBNull.Value">
          <oldString><![CDATA[AND expirationDate BETWEEN @initialExpirationDate AND @finalExpirationDate]]></oldString>
          <newString><![CDATA[]]></newString>
        </replaceByParamValue>
        <replaceByParamValue paramName="finalExpirationDate" paramValue="DBNull.Value">
          <oldString><![CDATA[AND expirationDate BETWEEN @initialExpirationDate AND @finalExpirationDate]]></oldString>
          <newString><![CDATA[]]></newString>
        </replaceByParamValue>
        <replaceByParamValue paramName="lastUpdatedBy" paramValue="">
					<oldString><![CDATA[AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
			</replaceByParamValues>
			<parameters>
				<param key="id" name="@id" type="UniqueIdentifier" direction="Input"/>
				<param key="title" name="@title" type="VarChar" direction="Input"/>
				<param key="description" name="@description" type="VarChar" direction="Input"/>
				<param key="content" name="@content" type="VarChar" direction="Input"/>
				<param key="author" name="@author" type="VarChar" direction="Input"/>
				<param key="isVisible" name="@isVisible" type="Bit" direction="Input"/>
				<param key="slug" name="@slug" type="VarChar" direction="Input"/>
				<param key="category" name="@category" type="VarChar" direction="Input"/>
				<param key="keywords" name="@keywords" type="VarChar" direction="Input"/>
				<param key="initialDateCreated" name="@initialDateCreated" type="DateTime" direction="Input"/>
				<param key="finalDateCreated" name="@finalDateCreated" type="DateTime" direction="Input"/>
				<param key="initialLastUpdated" name="@initialLastUpdated" type="DateTime" direction="Input"/>
				<param key="finalLastUpdated" name="@finalLastUpdated" type="DateTime" direction="Input"/>
        <param key="initialExpirationDate" name="@initialExpirationDate" type="DateTime" direction="Input"/>
        <param key="finalExpirationDate" name="@finalExpirationDate" type="DateTime" direction="Input"/>
        <param key="lastUpdatedBy" name="@lastUpdatedBy" type="VarChar" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
        <param key="firstIndex" name="@firstIndex" type="Int" direction="Input"/>
				<param key="lastIndex" name="@lastIndex" type="Int" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="SelectWikiHistory" type="Text">
			<commandText>
				<![CDATA[
				SELECT id, title, description, [content], author, isVisible, slug, category, 
					keywords, dateCreated, lastUpdated, expirationDate, lastUpdatedBy, reachLevel, editable, 
					editor, departmentArea, status, messages, authorizer, action, ipAddress
				FROM wikisHistory
				WHERE trackingNumber = @trackingNumber
				]]>
			</commandText>
			<parameters>
				<param key="trackingNumber" name="@trackingNumber" type="UniqueIdentifier" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="UpdateWikiHistory" type="Text">
			<commandText>
				<![CDATA[
				UPDATE wikisHistory
				SET id = @id, title = @title, description = @description, [content] = @content, author = @author, 
					isVisible = @isVisible, slug = @slug, category = @category, keywords = @keywords, 
					dateCreated = @dateCreated, lastUpdated = @lastUpdated, expirationDate = @expirationDate,
					lastUpdatedBy = @lastUpdatedBy, reachLevel = @reachLevel, editable = @editable,
					editor = @editor, departmentArea = @departmentArea, status = @status, messages = @messages,
					authorizer = @authorizer, action = @action, ipAddress = @ipAddress, applicationName = @applicationName
				WHERE trackingNumber = @trackingNumber
				]]>
			</commandText>
			<parameters>
				<param key="trackingNumber" name="@trackingNumber" type="UniqueIdentifier" direction="Input"/>
				<param key="id" name="@id" type="UniqueIdentifier" direction="Input"/>
				<param key="title" name="@title" type="VarChar" direction="Input"/>
				<param key="description" name="@description" type="VarChar" direction="Input"/>
				<param key="content" name="@content" type="VarChar" direction="Input"/>
				<param key="author" name="@author" type="VarChar" direction="Input"/>
				<param key="isVisible" name="@isVisible" type="Bit" direction="Input"/>
				<param key="slug" name="@slug" type="VarChar" direction="Input" isNullable="true"/>
				<param key="category" name="@category" type="VarChar" direction="Input"/>
				<param key="keywords" name="@keywords" type="VarChar" direction="Input" isNullable="true"/>
				<param key="dateCreated" name="@dateCreated" type="DateTime" direction="Input"/>
				<param key="lastUpdated" name="@lastUpdated" type="DateTime" direction="Input" isNullable="true"/>
				<param key="expirationDate" name="@expirationDate" type="DateTime" direction="Input" isNullable="true"/>
				<param key="lastUpdatedBy" name="@lastUpdatedBy" type="VarChar" direction="Input" isNullable="true"/>
				<param key="reachLevel" name="@reachLevel" type="Int" direction="Input"/>
				<param key="editable" name="@editable" type="Bit" direction="Input"/>
				<param key="editor" name="@editor" type="VarChar" direction="Input"/>
				<param key="departmentArea" name="@departmentArea" type="VarChar" direction="Input"/>
				<param key="status" name="@status" type="Int" direction="Input"/>
				<param key="messages" name="@messages" type="VarChar" direction="Input" isNullable="true"/>
				<param key="authorizer" name="@authorizer" type="VarChar" direction="Input" isNullable="true"/>
				<param key="action" name="@action" type="Int" direction="Input"/>
				<param key="ipAddress" name="@ipAddress" type="VarChar" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
		</dataCommand>
		<dataCommand name="InsertWikiHistory" type="Text">
			<commandText>
				<![CDATA[
				INSERT INTO wikisHistory
				(id, trackingNumber, title, description, [content], author, isVisible, slug, 
					category, keywords, dateCreated, lastUpdated, expirationDate, lastUpdatedBy, reachLevel, editable, 
					editor, departmentArea, status, messages, authorizer, action, ipAddress, applicationName)
				VALUES (@id, @trackingNumber, @title, @description, @content, @author, @isVisible, @slug, 
					@category, @keywords, @dateCreated, @lastUpdated, @expirationDate, @lastUpdatedBy, @reachLevel, @editable, 
					@editor, @departmentArea, @status, @messages, @authorizer, @action, @ipAddress, @applicationName)
				]]>
			</commandText>
			<parameters>
				<param key="trackingNumber" name="@trackingNumber" type="UniqueIdentifier" direction="Input"/>
				<param key="id" name="@id" type="UniqueIdentifier" direction="Input"/>
				<param key="title" name="@title" type="VarChar" direction="Input"/>
				<param key="description" name="@description" type="VarChar" direction="Input"/>
				<param key="content" name="@content" type="VarChar" direction="Input"/>
				<param key="author" name="@author" type="VarChar" direction="Input"/>
				<param key="isVisible" name="@isVisible" type="Bit" direction="Input"/>
				<param key="slug" name="@slug" type="VarChar" direction="Input" isNullable="true"/>
				<param key="category" name="@category" type="VarChar" direction="Input"/>
				<param key="keywords" name="@keywords" type="VarChar" direction="Input" isNullable="true"/>
				<param key="dateCreated" name="@dateCreated" type="DateTime" direction="Input"/>
				<param key="lastUpdated" name="@lastUpdated" type="DateTime" direction="Input" isNullable="true"/>
				<param key="expirationDate" name="@expirationDate" type="DateTime" direction="Input" isNullable="true"/>
				<param key="lastUpdatedBy" name="@lastUpdatedBy" type="VarChar" direction="Input" isNullable="true"/>
				<param key="reachLevel" name="@reachLevel" type="Int" direction="Input"/>
				<param key="editable" name="@editable" type="Bit" direction="Input"/>
				<param key="editor" name="@editor" type="VarChar" direction="Input"/>
				<param key="departmentArea" name="@departmentArea" type="VarChar" direction="Input"/>
				<param key="status" name="@status" type="Int" direction="Input"/>
				<param key="messages" name="@messages" type="VarChar" direction="Input" isNullable="true"/>
				<param key="authorizer" name="@authorizer" type="VarChar" direction="Input" isNullable="true"/>
				<param key="action" name="@action" type="Int" direction="Input"/>
				<param key="ipAddress" name="@ipAddress" type="VarChar" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
		</dataCommand>
		<dataCommand name="DeleteWikiHistory" type="Text">
			<commandText>
				<![CDATA[
				DELETE wikisHistory
				WHERE trackingNumber = @trackingNumber
				]]>
			</commandText>
			<parameters>
				<param key="trackingNumber" name="@trackingNumber" type="UniqueIdentifier" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="GetPendingAuthorizations" type="Text">
			<commandText>
				<![CDATA[
				SELECT COUNT(trackingNumber) totalCount
				FROM workWikiItems
				WHERE 1 = 1
					AND authorizer = @authorizer
					AND status = @status;
				WITH Ordered(rowNumber, trackingNumber) AS (
					SELECT ROW_NUMBER() OVER (ORDER BY dateRequested DESC) rowNumber, trackingNumber
					FROM (
						SELECT trackingNumber, ISNULL(lastUpdated, dateCreated) dateRequested
						FROM workWikiItems
						WHERE applicationName = @applicationName
							AND authorizer = @authorizer
							AND status = @status
					) Ordered
				) 
				SELECT trackingNumber
				FROM Ordered
				WHERE rowNumber BETWEEN @firstIndex AND @lastIndex;
				]]>
			</commandText>
			<replaceByParamValues>
				<replaceByParamValue paramName="authorizer" paramValue="">
					<oldString><![CDATA[AND authorizer = @authorizer]]></oldString>
					<newString></newString>
				</replaceByParamValue>
			</replaceByParamValues>
			<parameters>
				<param key="authorizer" name="@authorizer" type="VarChar" direction="Input" />
				<param key="status" name="@status" type="Int" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
        <param key="firstIndex" name="@firstIndex" type="Int" direction="Input"/>
				<param key="lastIndex" name="@lastIndex" type="Int" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="GetWikiAuthorizer" type="Text">
			<commandText>
				<![CDATA[
				SELECT TOP 1 username
				FROM wikiAuthorizers
				WHERE applicationName = @applicationName
          AND category = @category
				]]>
			</commandText>
			<parameters>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
        <param key="category" name="@category" type="VarChar" direction="Input"/>
      </parameters>
		</dataCommand>
		<dataCommand name="GetAuthorizersByCategory" type="Text">
			<commandText>
				<![CDATA[
				SELECT COUNT(*) totalCount
				FROM wikiAuthorizers
        WHERE applicationName = @applicationName;
				WITH Ordered(rowNumber, category, username) AS (
					SELECT ROW_NUMBER() OVER (ORDER BY category ASC), category, username
					FROM wikiAuthorizers
          WHERE applicationName = @applicationName
				)
				SELECT category, username
				FROM Ordered
				WHERE rowNumber BETWEEN @firstIndex AND @lastIndex;
				]]>
			</commandText>
			<parameters>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
        <param key="firstIndex" name="@firstIndex" type="Int" direction="Input"/>
				<param key="lastIndex" name="@lastIndex" type="Int" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="AddAuthorizerByCategory" type="text">
			<commandText>
				<![CDATA[
				INSERT INTO wikiAuthorizers
				(category, username, applicationName) VALUES (@category, @username, @applicationName)
				]]>
			</commandText>
			<parameters>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
        <param key="category" name="@category" type="VarChar" direction="Input"/>
				<param key="username" name="@username" type="VarChar" direction="Input" />
			</parameters>
		</dataCommand>
		<dataCommand name="DeleteAuthorizerByCategory" type="text">
			<commandText>
				<![CDATA[
				DELETE wikiAuthorizers
				WHERE applicationName = @applicationName
          AND category = @category
				]]>
			</commandText>
			<parameters>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
        <param key="category" name="@category" type="VarChar" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="GetRelatedWiki" type="Text">
			<commandText>
				<![CDATA[
				---- Create the variables for the random number generation
				DECLARE @random INT;
				DECLARE @upper INT;
				DECLARE @lower INT;

				---- This will create a random number between 1 and 999
				SET @lower = 1					---- The lowest random number
				SELECT @upper = COUNT(id) + 1	---- The highest random number
				FROM wikis
				WHERE applicationName = @applicationName
          AND isVisible = 1
					AND keywords LIKE '%%' + @keyword + '%%';

				SET @random = ROUND(((@upper - @lower -1) * RAND() + @lower), 0);

				WITH Ordered(rowNumber, id) AS (
					SELECT ROW_NUMBER() OVER (ORDER BY lastUpdated DESC), id
					FROM wikis
					WHERE applicationName = @applicationName
            AND isVisible = 1
						AND keywords LIKE '%%' + @keyword + '%%'
				)
				SELECT id
				FROM Ordered
				WHERE rowNumber = @random;
				]]>
			</commandText>
			<parameters>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
        <param key="keyword" name="@keyword" type="VarChar" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="GetRandomWiki" type="Text">
			<commandText>
				<![CDATA[
				---- Create the variables for the random number generation
				DECLARE @random INT;
				DECLARE @upper INT;
				DECLARE @lower INT;

				---- This will create a random number between 1 and 999
				SET @lower = 1					---- The lowest random number
				SELECT @upper = COUNT(id) + 1	---- The highest random number
				FROM wikis
				WHERE applicationName = @applicationName
          AND isVisible = 1;

				SET @random = ROUND(((@upper - @lower -1) * RAND() + @lower), 0);

				WITH Ordered(rowNumber, id) AS (
					SELECT ROW_NUMBER() OVER (ORDER BY lastUpdated DESC), id
					FROM wikis
					WHERE applicationName = @applicationName
            AND isVisible = 1
				)
				SELECT id
				FROM Ordered
				WHERE rowNumber = @random;
				]]>
			</commandText>
      <parameters>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
		</dataCommand>
		<dataCommand name="SearchWiki" type="Text">
			<commandText>
				<![CDATA[
				-- SQL SERVER 2005
				WITH Ordered(id) AS (
					SELECT DISTINCT id
					FROM (
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 110 rate
						FROM wikis
						WHERE applicationName = @applicationName AND title = @title
						UNION
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 100 rate
						FROM wikis
						WHERE applicationName = @applicationName AND title like '%%' + @title + '%%'
						UNION
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 90 rate
						FROM wikis
						WHERE applicationName = @applicationName AND keywords like '%%' + @keywords + '%%'
						UNION
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 80 rate
						FROM wikis
						WHERE applicationName = @applicationName AND category = @category
						UNION
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 70 rate
						FROM wikis
						WHERE applicationName = @applicationName AND description like '%%' + @description + '%%'
						UNION
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 60 rate
						FROM wikis
						WHERE applicationName = @applicationName AND [content] like '%%' + @content + '%%'
					) Results
					WHERE id <> '00000000-0000-0000-0000-000000000000'
						AND slug like '%%' + @slug + '%%'
						AND author like '%%' + @author + '%%'
						AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%'
						AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated
						AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated
						AND isVisible = @isVisible
						AND reachLevel >= @reachLevel
				)
				SELECT COUNT(id) totalCount
				FROM Ordered;
				WITH Ordered(rowNumber, id, rate) AS (
					SELECT ROW_NUMBER() OVER (ORDER BY rate DESC), id, rate
					FROM (
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 110 rate
						FROM wikis
						WHERE applicationName = @applicationName AND title = @title
						UNION
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 100 rate
						FROM wikis
						WHERE applicationName = @applicationName AND title like '%%' + @title + '%%'
						UNION
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 90 rate
						FROM wikis
						WHERE applicationName = @applicationName AND keywords like '%%' + @keywords + '%%'
						UNION
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 80 rate
						FROM wikis
						WHERE applicationName = @applicationName AND category = @category
						UNION
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 70 rate
						FROM wikis
						WHERE applicationName = @applicationName AND description like '%%' + @description + '%%'
						UNION
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 60 rate
						FROM wikis
						WHERE applicationName = @applicationName AND [content] like '%%' + @content + '%%'
					) Results
					WHERE id <> '00000000-0000-0000-0000-000000000000'
						AND slug like '%%' + @slug + '%%'
						AND author like '%%' + @author + '%%'
						AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%'
						AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated
						AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated
						AND isVisible = @isVisible
						AND reachLevel >= @reachLevel
				)
				SELECT ROW_NUMBER() OVER (ORDER BY rowNumber ASC) rowNumber, id
				FROM (
					SELECT DISTINCT o.id, (SELECT TOP 1 rowNumber
						FROM Ordered
						WHERE id = o.id) rowNumber
					FROM Ordered o
				) ReOrdered
				WHERE rowNumber BETWEEN @firstIndex AND @lastIndex;
				]]>
			</commandText>
			<replaceByParamValues>
				<replaceByParamValue paramName="title" paramValue="">
					<oldString>
						<![CDATA[SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 110 rate
						FROM wikis
						WHERE applicationName = @applicationName AND title = @title
						UNION
						SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 100 rate
						FROM wikis
						WHERE applicationName = @applicationName AND title like '%%' + @title + '%%']]>
					</oldString>
					<newString><![CDATA[SELECT '00000000-0000-0000-0000-000000000000' id, null slug, null category, 0 reachLevel, null author, null lastUpdatedBy, null dateCreated, null lastUpdated, 0 isVisible, 0 rate]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="keywords" paramValue="">
					<oldString>
						<![CDATA[SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 90 rate
						FROM wikis
						WHERE applicationName = @applicationName AND keywords like '%%' + @keywords + '%%']]>
					</oldString>
					<newString><![CDATA[SELECT '00000000-0000-0000-0000-000000000000' id, null slug, null category, 0 reachLevel, null author, null lastUpdatedBy, null dateCreated, null lastUpdated, 0 isVisible, 0 rate]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="category" paramValue="">
					<oldString>
						<![CDATA[SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 80 rate
						FROM wikis
						WHERE applicationName = @applicationName AND category = @category]]>
					</oldString>
					<newString><![CDATA[SELECT '00000000-0000-0000-0000-000000000000' id, null slug, null category, 0 reachLevel, null author, null lastUpdatedBy, null dateCreated, null lastUpdated, 0 isVisible, 0 rate]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="description" paramValue="">
					<oldString>
						<![CDATA[SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 70 rate
						FROM wikis
						WHERE applicationName = @applicationName AND description like '%%' + @description + '%%']]>
					</oldString>
					<newString><![CDATA[SELECT '00000000-0000-0000-0000-000000000000' id, null slug, null category, 0 reachLevel, null author, null lastUpdatedBy, null dateCreated, null lastUpdated, 0 isVisible, 0 rate]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="content" paramValue="">
					<oldString>
						<![CDATA[SELECT id, slug, category, reachLevel, author, lastUpdatedBy, dateCreated, lastUpdated, isVisible, 60 rate
						FROM wikis
						WHERE applicationName = @applicationName AND [content] like '%%' + @content + '%%']]>
					</oldString>
					<newString><![CDATA[SELECT '00000000-0000-0000-0000-000000000000' id, null slug, null category, 0 reachLevel, null author, null lastUpdatedBy, null dateCreated, null lastUpdated, 0 isVisible, 0 rate]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="author" paramValue="">
					<oldString><![CDATA[AND author like '%%' + @author + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="isVisible" paramValue="DBNull.Value">
					<oldString><![CDATA[AND isVisible = @isVisible]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="slug" paramValue="">
					<oldString><![CDATA[AND slug like '%%' + @slug + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="category" paramValue="">
					<oldString><![CDATA[AND category like '%%' + @category + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="initialDateCreated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="finalDateCreated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND dateCreated BETWEEN @initialDateCreated AND @finalDateCreated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="initialLastUpdated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="finalLastUpdated" paramValue="DBNull.Value">
					<oldString><![CDATA[AND lastUpdated BETWEEN @initialLastUpdated AND @finalLastUpdated]]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
				<replaceByParamValue paramName="lastUpdatedBy" paramValue="">
					<oldString><![CDATA[AND lastUpdatedBy like '%%' + @lastUpdatedBy + '%%']]></oldString>
					<newString><![CDATA[]]></newString>
				</replaceByParamValue>
			</replaceByParamValues>
			<parameters>
				<param key="title" name="@title" type="VarChar" direction="Input"/>
				<param key="description" name="@description" type="VarChar" direction="Input"/>
				<param key="content" name="@content" type="VarChar" direction="Input"/>
				<param key="author" name="@author" type="VarChar" direction="Input"/>
				<param key="isVisible" name="@isVisible" type="Bit" direction="Input"/>
				<param key="reachLevel" name="@reachLevel" type="Int" direction="Input"/>
				<param key="slug" name="@slug" type="VarChar" direction="Input"/>
				<param key="category" name="@category" type="VarChar" direction="Input"/>
				<param key="keywords" name="@keywords" type="VarChar" direction="Input"/>
				<param key="initialDateCreated" name="@initialDateCreated" type="DateTime" direction="Input"/>
				<param key="finalDateCreated" name="@finalDateCreated" type="DateTime" direction="Input"/>
				<param key="initialLastUpdated" name="@initialLastUpdated" type="DateTime" direction="Input"/>
				<param key="finalLastUpdated" name="@finalLastUpdated" type="DateTime" direction="Input"/>
				<param key="lastUpdatedBy" name="@lastUpdatedBy" type="VarChar" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
        <param key="firstIndex" name="@firstIndex" type="Int" direction="Input"/>
				<param key="lastIndex" name="@lastIndex" type="Int" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="AlphabeticalSearchWikiTotal" type="Text">
			<commandText>
				<![CDATA[
				-- SQL SERVER 2005
					WITH Ordered(id) AS (
					SELECT DISTINCT id
					FROM (
						SELECT id
						FROM wikis
						WHERE applicationName = @applicationName
              AND keywords like @alphabeticalIndex + '%%'
						UNION
						SELECT id
						FROM wikis
						WHERE applicationName = @applicationName
              AND title like @alphabeticalIndex + '%%'
					) Results
					WHERE id <> '00000000-0000-0000-0000-000000000000'
				)
				SELECT COUNT(id)
				FROM Ordered;
				]]>
			</commandText>
			<parameters>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
        <param key="alphabeticalIndex" name="@alphabeticalIndex" type="VarChar" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="AlphabeticalSearchArticle" type="Text">
			<commandText>
				<![CDATA[
				-- SQL SERVER 2005
				WITH Ordered(rowNumber, id, rate) AS (
					SELECT ROW_NUMBER() OVER (ORDER BY rate DESC), id, rate
					FROM (
						SELECT id, 100 rate
						FROM wikis
						WHERE applicationName = @applicationName
              AND title like @alphabeticalIndex + '%%'
						UNION
						SELECT id, 90 rate
						FROM wikis
						WHERE applicationName = @applicationName
              AND keywords like @alphabeticalIndex + '%%'
					) Results
					WHERE id <> '00000000-0000-0000-0000-000000000000'
				)
				SELECT DISTINCT id
				FROM Ordered
				WHERE rowNumber BETWEEN @firstIndex AND @lastIndex;
				]]>
			</commandText>
			<parameters>
				<param key="alphabeticalIndex" name="@alphabeticalIndex" type="VarChar" direction="Input"/>
			</parameters>
		</dataCommand>
		<dataCommand name="GetAllCategories" type="text">
			<commandText>
				<![CDATA[
        SELECT category
        FROM (
          SELECT DISTINCT categoryName COLLATE Modern_Spanish_CI_AS category 
          FROM WikiCategories
          WHERE applicationName = @applicationName
          UNION
          SELECT DISTINCT category COLLATE Modern_Spanish_CI_AS 
          FROM Wikis
          WHERE applicationName = @applicationName
        ) categories
        ORDER BY category
        ]]>
			</commandText>
      <parameters>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
		</dataCommand>
    <dataCommand name="GetCategories" type="text">
      <commandText>
        <![CDATA[
				SELECT DISTINCT categoryName category
				FROM WikiCategories
        WHERE applicationName = @applicationName
        ORDER BY categoryName
				]]>
      </commandText>
      <parameters>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
    </dataCommand>
    <dataCommand name="CreateCategory" type="Text">
      <commandText>
        <![CDATA[
        INSERT INTO WikiCategories
        (categoryName, applicationName) VALUES (@category, @applicationName)
        ]]>
      </commandText>
      <parameters>
        <param key="category" name="@category" type="VarChar" size="50" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
    </dataCommand>
    <dataCommand name="DeleteCategory" type="Text">
      <commandText>
        <![CDATA[
        DELETE WikiCategories
        WHERE categoryName = @category
          AND applicationName = @applicationName
        ]]>
      </commandText>
      <parameters>
        <param key="category" name="@category" type="VarChar" size="50" direction="Input"/>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
    </dataCommand>
    <dataCommand name="GetTagCloud" type="StoredProcedure">
      <commandText>TagCloud</commandText>
      <parameters>
        <param key="applicationName" name="@applicationName" type="VarChar" size="512" direction="Input"/>
      </parameters>
    </dataCommand>
	</dataCommands>
</dataOperations>
